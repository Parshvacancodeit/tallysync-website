{% extends "base.html" %}
{% block title %}TallySync{% endblock %}

{% block content %}
<h1>TallySync ‚Äì XML Tester</h1>
<p style="color:#666;margin-bottom:2rem;">
    Upload a Tally XML file and sync it directly with Tally.
</p>

<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem;">

    <div style="margin-top: 3rem; padding: 1.5rem; background: {% if connector_configured %}#d4edda{% else %}#fff3cd{% endif %}; border-radius: 1rem;">
    <h3>{% if connector_configured %}‚úÖ{% else %}‚ö†Ô∏è{% endif %} Connector Status</h3>
    <p style="margin: 1rem 0;">
        {% if connector_configured %}
            Connector is configured and ready to receive data.
        {% else %}
            Connector not configured. Please configure in settings to send data.
        {% endif %}
    </p>
    <a href="{{ url_for('settings') }}" class="btn {% if connector_configured %}btn-secondary{% else %}btn-primary{% endif %}">
        {% if connector_configured %}Update Settings{% else %}Configure Now{% endif %}
    </a>
</div>


    <!-- Upload XML -->
    <div style="padding:2rem;background:#f8f9fa;border-radius:1rem;border-left:4px solid #0d6efd;">
        <h3>üìÑ Upload XML</h3>
        <p style="color:#666;margin:1rem 0;">
            Upload a Tally-compatible XML file
        </p>
        <a href="{{ url_for('upload_xml') }}" class="btn btn-primary">
            Upload XML
        </a>
    </div>

    <!-- Sync with Tally -->
    <div style="padding:2rem;background:#f8f9fa;border-radius:1rem;border-left:4px solid #198754;">
        <h3>üöÄ Sync with Tally</h3>
        <p style="color:#666;margin:1rem 0;">
            Send uploaded XML to local Tally via connector
        </p>

        <form method="POST" action="{{ url_for('sync_with_tally') }}">
            <button class="btn btn-success"
                {% if not session.get('xml_data') %}disabled{% endif %}>
                Sync with Tally
            </button>
        </form>

        {% if not session.get('xml_data') %}
        <small style="color:#999;display:block;margin-top:0.5rem;">
            Upload XML first
        </small>
        {% endif %}
    </div>

</div>
{% endblock %}
